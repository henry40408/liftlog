{% extends "base.html" %}

{% block title %}Users - LiftLog{% endblock %}

{% block content %}
{% include "nav.html" %}

<h1>Users</h1>

{% if is_admin %}
<p><a href="/users/new">+ Add New User</a></p>
{% endif %}

<table>
    <thead>
        <tr>
            <th>Username</th>
            <th>Role</th>
            <th>Created</th>
            {% if is_admin %}
            <th>Actions</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for u in users %}
        <tr>
            <td>{{ u.username }}</td>
            <td>{{ u.role.as_str() }}</td>
            <td class="muted">{{ u.created_at.format("%Y-%m-%d %H:%M") }}</td>
            {% if is_admin %}
            <td>
                {% if u.id != user.id %}
                <div class="actions">
                    {% if !u.role.is_admin() %}
                    <form action="/users/{{ u.id }}/promote" method="post" style="display:inline;" onsubmit="return confirm('Promote {{ u.username }} to admin?');">
                        <button type="submit">Promote</button>
                    </form>
                    {% endif %}
                    <form action="/users/{{ u.id }}/delete" method="post" style="display:inline;" onsubmit="return confirm('Delete user {{ u.username }}?');">
                        <button type="submit" class="btn-danger">Delete</button>
                    </form>
                </div>
                {% else %}
                <span class="muted">(you)</span>
                {% endif %}
            </td>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
